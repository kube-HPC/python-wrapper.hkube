language: python
stages:
  - Tests
  - Coverage
  - Github
  - Deploy
services:
  - docker

jobs:
  fast_finish: true
  include:
    - stage: Tests
    - python: 2.7
      script: ./tools/ci/tests.sh
    - python: 3.4
      script: ./tools/ci/tests.sh
    - python: 3.5
      script: ./tools/ci/tests.sh
    - python: 3.6
      script: ./tools/ci/tests.sh
    - python: 3.7
      script: ./tools/ci/tests.sh
    - python: 3.8
      script: ./tools/ci/tests.sh

    - stage: Coverage
      script: ./tools/ci/coverage.sh

    - stage: Github
      script: ./tools/ci/github.sh

    - stage: Deploy
      script: echo "Starting Pypi deploy"
      deploy:
        provider: pypi
        username: ${PYPI_USER}
        password: ${PYPI_PASSWORD}
        on:
          branch: master
